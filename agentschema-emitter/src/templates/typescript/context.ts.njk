{# Template for generating TypeScript LoadContext and SaveContext classes #}
// Copyright (c) Microsoft. All rights reserved.
// WARNING: This is an auto-generated file. DO NOT EDIT THIS FILE DIRECTLY.

import * as yaml from "yaml";

/**
 * Context for customizing the loading process of agent definitions.
 *
 * Provides hooks for pre-processing input data before parsing and
 * post-processing output data after instantiation.
 */
export class LoadContext {
  /**
   * Optional callback to transform input data before parsing.
   */
  preProcess?: (data: Record<string, unknown>) => Record<string, unknown>;

  /**
   * Optional callback to transform the result after instantiation.
   */
  postProcess?: (result: unknown) => unknown;

  constructor(init?: Partial<LoadContext>) {
    if (init?.preProcess) {
      this.preProcess = init.preProcess;
    }
    if (init?.postProcess) {
      this.postProcess = init.postProcess;
    }
  }

  /**
   * Apply pre-processing to input data if a preProcess callback is set.
   * @param data - The raw input dictionary to process.
   * @returns The processed dictionary, or the original if no callback is set.
   */
  processInput(data: Record<string, unknown>): Record<string, unknown> {
    if (this.preProcess) {
      return this.preProcess(data);
    }
    return data;
  }

  /**
   * Apply post-processing to the result if a postProcess callback is set.
   * @param result - The instantiated object to process.
   * @returns The processed result, or the original if no callback is set.
   */
  processOutput<T>(result: T): T {
    if (this.postProcess) {
      return this.postProcess(result) as T;
    }
    return result;
  }
}

/**
 * Context for customizing the serialization process of agent definitions.
 *
 * Provides hooks for pre-processing the object before serialization and
 * post-processing the dictionary after serialization.
 */
export class SaveContext {
  /**
   * Optional callback to transform the object before serialization.
   */
  preSave?: (obj: unknown) => unknown;

  /**
   * Optional callback to transform the dictionary after serialization.
   */
  postSave?: (data: Record<string, unknown>) => Record<string, unknown>;

  /**
   * Output format for collections: "object" (name as key) or "array" (list of dicts).
   * Defaults to "object".
   */
  collectionFormat: "object" | "array" = "object";

  /**
   * Use shorthand scalar representation when possible.
   * Defaults to true.
   */
  useShorthand: boolean = true;

  constructor(init?: Partial<SaveContext>) {
    if (init?.preSave) {
      this.preSave = init.preSave;
    }
    if (init?.postSave) {
      this.postSave = init.postSave;
    }
    if (init?.collectionFormat) {
      this.collectionFormat = init.collectionFormat;
    }
    if (init?.useShorthand !== undefined) {
      this.useShorthand = init.useShorthand;
    }
  }

  /**
   * Apply pre-processing to the object if a preSave callback is set.
   * @param obj - The object to process before serialization.
   * @returns The processed object, or the original if no callback is set.
   */
  processObject<T>(obj: T): T {
    if (this.preSave) {
      return this.preSave(obj) as T;
    }
    return obj;
  }

  /**
   * Apply post-processing to the dictionary if a postSave callback is set.
   * @param data - The serialized dictionary to process.
   * @returns The processed dictionary, or the original if no callback is set.
   */
  processDict(data: Record<string, unknown>): Record<string, unknown> {
    if (this.postSave) {
      return this.postSave(data);
    }
    return data;
  }

  /**
   * Convert a dictionary to a YAML string.
   * @param data - The dictionary to convert.
   * @returns The YAML string representation.
   */
  toYaml(data: Record<string, unknown>): string {
    return yaml.stringify(data, { indent: 2 });
  }

  /**
   * Convert a dictionary to a JSON string.
   * @param data - The dictionary to convert.
   * @param indent - Number of spaces for indentation.
   * @returns The JSON string representation.
   */
  toJson(data: Record<string, unknown>, indent: number = 2): string {
    return JSON.stringify(data, null, indent);
  }
}
