##########################################
# WARNING: This is an auto-generated file.
# DO NOT EDIT THIS FILE DIRECTLY
# ANY EDITS WILL BE LOST
##########################################

from dataclasses import dataclass, field
from typing import Any, Optional

from ._context import LoadContext
from ._Property import Property



@dataclass
class PropertySchema:
    """Definition for the property schema of a model.
    This includes the properties and example records.
    
    Attributes
    ----------
    examples : Optional[dict[str, Any]]
        Example records for the input schema
    strict : Optional[bool]
        Whether the input schema is strict - if true, only the defined properties are allowed
    properties : list[Property]
        The input properties for the schema
    """

    examples: Optional[dict[str, Any]] = field(default_factory=list)
    strict: Optional[bool] = None
    properties: list[Property] = field(default_factory=list)

    @staticmethod
    def load(data: Any, context: Optional[LoadContext] = None) -> "PropertySchema":
        """Load a PropertySchema instance.
        Args:
            data (Any): The data to load the instance from.
            context (Optional[LoadContext]): Optional context with pre/post processing callbacks.
        Returns:
            PropertySchema: The loaded PropertySchema instance.

        """
        
        if context is not None:
            data = context.process_input(data)
        
        if not isinstance(data, dict):
            raise ValueError(f"Invalid data for PropertySchema: {data}")

        # create new instance
        instance = PropertySchema()

        if data is not None and "examples" in data:
            instance.examples = data["examples"]
        if data is not None and "strict" in data:
            instance.strict = data["strict"]
        if data is not None and "properties" in data:
            instance.properties = PropertySchema.load_properties(data["properties"], context)
        if context is not None:
            instance = context.process_output(instance)
        return instance


    @staticmethod
    def load_properties(data: dict | list, context: Optional[LoadContext]) -> list[Property]:
        if isinstance(data, dict):
            # convert simple named properties to list of Property
            if(len(data.keys()) == 1):
                data = [ {"name": k, "kind": v} for k, v in data.items() ]
            else:
                data = [ {"name": k, **v} for k, v in data.items() ]
        return [Property.load(item, context) for item in data]


