// Code generated by AgentSchema emitter; DO NOT EDIT.

package agentschema_test

import (
	"encoding/json"
	"testing"

	"gopkg.in/yaml.v3"

	"github.com/microsoft/agentschema-go/agentschema"
)

// TestModelOptionsLoadJSON tests loading ModelOptions from JSON
func TestModelOptionsLoadJSON(t *testing.T) {
	jsonData := `
{
  "frequencyPenalty": 0.5,
  "maxOutputTokens": 2048,
  "presencePenalty": 0.3,
  "seed": 42,
  "temperature": 0.7,
  "topK": 40,
  "topP": 0.9,
  "stopSequences": [
    "\n",
    "###"
  ],
  "allowMultipleToolCalls": true,
  "additionalProperties": {
    "customProperty": "value",
    "anotherProperty": "anotherValue"
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadModelOptions(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load ModelOptions: %v", err)
	}
	if instance.FrequencyPenalty == nil || *instance.FrequencyPenalty != 0.5 {
		t.Errorf(`Expected FrequencyPenalty to be 0.5, got %v`, instance.FrequencyPenalty)
	}
	if instance.MaxOutputTokens == nil || *instance.MaxOutputTokens != 2048 {
		t.Errorf(`Expected MaxOutputTokens to be 2048, got %v`, instance.MaxOutputTokens)
	}
	if instance.PresencePenalty == nil || *instance.PresencePenalty != 0.3 {
		t.Errorf(`Expected PresencePenalty to be 0.3, got %v`, instance.PresencePenalty)
	}
	if instance.Seed == nil || *instance.Seed != 42 {
		t.Errorf(`Expected Seed to be 42, got %v`, instance.Seed)
	}
	if instance.Temperature == nil || *instance.Temperature != 0.7 {
		t.Errorf(`Expected Temperature to be 0.7, got %v`, instance.Temperature)
	}
	if instance.TopK == nil || *instance.TopK != 40 {
		t.Errorf(`Expected TopK to be 40, got %v`, instance.TopK)
	}
	if instance.TopP == nil || *instance.TopP != 0.9 {
		t.Errorf(`Expected TopP to be 0.9, got %v`, instance.TopP)
	}
	if instance.AllowMultipleToolCalls == nil || *instance.AllowMultipleToolCalls != true {
		t.Errorf(`Expected AllowMultipleToolCalls to be true, got %v`, instance.AllowMultipleToolCalls)
	}
}

// TestModelOptionsLoadYAML tests loading ModelOptions from YAML
func TestModelOptionsLoadYAML(t *testing.T) {
	yamlData := `
frequencyPenalty: 0.5
maxOutputTokens: 2048
presencePenalty: 0.3
seed: 42
temperature: 0.7
topK: 40
topP: 0.9
stopSequences:
  - |+
    
  - "###"
allowMultipleToolCalls: true
additionalProperties:
  customProperty: value
  anotherProperty: anotherValue

`
	var data map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlData), &data); err != nil {
		t.Fatalf("Failed to parse YAML: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadModelOptions(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load ModelOptions: %v", err)
	}
	if instance.FrequencyPenalty == nil || *instance.FrequencyPenalty != 0.5 {
		t.Errorf(`Expected FrequencyPenalty to be 0.5, got %v`, instance.FrequencyPenalty)
	}
	if instance.MaxOutputTokens == nil || *instance.MaxOutputTokens != 2048 {
		t.Errorf(`Expected MaxOutputTokens to be 2048, got %v`, instance.MaxOutputTokens)
	}
	if instance.PresencePenalty == nil || *instance.PresencePenalty != 0.3 {
		t.Errorf(`Expected PresencePenalty to be 0.3, got %v`, instance.PresencePenalty)
	}
	if instance.Seed == nil || *instance.Seed != 42 {
		t.Errorf(`Expected Seed to be 42, got %v`, instance.Seed)
	}
	if instance.Temperature == nil || *instance.Temperature != 0.7 {
		t.Errorf(`Expected Temperature to be 0.7, got %v`, instance.Temperature)
	}
	if instance.TopK == nil || *instance.TopK != 40 {
		t.Errorf(`Expected TopK to be 40, got %v`, instance.TopK)
	}
	if instance.TopP == nil || *instance.TopP != 0.9 {
		t.Errorf(`Expected TopP to be 0.9, got %v`, instance.TopP)
	}
	if instance.AllowMultipleToolCalls == nil || *instance.AllowMultipleToolCalls != true {
		t.Errorf(`Expected AllowMultipleToolCalls to be true, got %v`, instance.AllowMultipleToolCalls)
	}
}

// TestModelOptionsRoundtrip tests load -> save -> load produces equivalent data
func TestModelOptionsRoundtrip(t *testing.T) {
	jsonData := `
{
  "frequencyPenalty": 0.5,
  "maxOutputTokens": 2048,
  "presencePenalty": 0.3,
  "seed": 42,
  "temperature": 0.7,
  "topK": 40,
  "topP": 0.9,
  "stopSequences": [
    "\n",
    "###"
  ],
  "allowMultipleToolCalls": true,
  "additionalProperties": {
    "customProperty": "value",
    "anotherProperty": "anotherValue"
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	loadCtx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadModelOptions(data, loadCtx)
	if err != nil {
		t.Fatalf("Failed to load ModelOptions: %v", err)
	}
	saveCtx := agentschema.NewSaveContext()
	savedData := instance.Save(saveCtx)

	reloaded, err := agentschema.LoadModelOptions(savedData, loadCtx)
	if err != nil {
		t.Fatalf("Failed to reload ModelOptions: %v", err)
	}
	if reloaded.FrequencyPenalty == nil || *reloaded.FrequencyPenalty != 0.5 {
		t.Errorf(`Expected FrequencyPenalty to be 0.5, got %v`, reloaded.FrequencyPenalty)
	}
	if reloaded.MaxOutputTokens == nil || *reloaded.MaxOutputTokens != 2048 {
		t.Errorf(`Expected MaxOutputTokens to be 2048, got %v`, reloaded.MaxOutputTokens)
	}
	if reloaded.PresencePenalty == nil || *reloaded.PresencePenalty != 0.3 {
		t.Errorf(`Expected PresencePenalty to be 0.3, got %v`, reloaded.PresencePenalty)
	}
	if reloaded.Seed == nil || *reloaded.Seed != 42 {
		t.Errorf(`Expected Seed to be 42, got %v`, reloaded.Seed)
	}
	if reloaded.Temperature == nil || *reloaded.Temperature != 0.7 {
		t.Errorf(`Expected Temperature to be 0.7, got %v`, reloaded.Temperature)
	}
	if reloaded.TopK == nil || *reloaded.TopK != 40 {
		t.Errorf(`Expected TopK to be 40, got %v`, reloaded.TopK)
	}
	if reloaded.TopP == nil || *reloaded.TopP != 0.9 {
		t.Errorf(`Expected TopP to be 0.9, got %v`, reloaded.TopP)
	}
	if reloaded.AllowMultipleToolCalls == nil || *reloaded.AllowMultipleToolCalls != true {
		t.Errorf(`Expected AllowMultipleToolCalls to be true, got %v`, reloaded.AllowMultipleToolCalls)
	}
}

// TestModelOptionsToJSON tests that ToJSON produces valid JSON
func TestModelOptionsToJSON(t *testing.T) {
	jsonData := `
{
  "frequencyPenalty": 0.5,
  "maxOutputTokens": 2048,
  "presencePenalty": 0.3,
  "seed": 42,
  "temperature": 0.7,
  "topK": 40,
  "topP": 0.9,
  "stopSequences": [
    "\n",
    "###"
  ],
  "allowMultipleToolCalls": true,
  "additionalProperties": {
    "customProperty": "value",
    "anotherProperty": "anotherValue"
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadModelOptions(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load ModelOptions: %v", err)
	}
	jsonOutput, err := instance.ToJSON()
	if err != nil {
		t.Fatalf("Failed to convert to JSON: %v", err)
	}

	var parsed map[string]interface{}
	if err := json.Unmarshal([]byte(jsonOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated JSON: %v", err)
	}
}

// TestModelOptionsToYAML tests that ToYAML produces valid YAML
func TestModelOptionsToYAML(t *testing.T) {
	jsonData := `
{
  "frequencyPenalty": 0.5,
  "maxOutputTokens": 2048,
  "presencePenalty": 0.3,
  "seed": 42,
  "temperature": 0.7,
  "topK": 40,
  "topP": 0.9,
  "stopSequences": [
    "\n",
    "###"
  ],
  "allowMultipleToolCalls": true,
  "additionalProperties": {
    "customProperty": "value",
    "anotherProperty": "anotherValue"
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadModelOptions(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load ModelOptions: %v", err)
	}
	yamlOutput, err := instance.ToYAML()
	if err != nil {
		t.Fatalf("Failed to convert to YAML: %v", err)
	}

	var parsed map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated YAML: %v", err)
	}
}
