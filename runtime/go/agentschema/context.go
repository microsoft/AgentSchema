// Copyright (c) Microsoft. All rights reserved.
// WARNING: This is an auto-generated file. DO NOT EDIT THIS FILE DIRECTLY.

package agentschema

import (
	"encoding/json"

	"gopkg.in/yaml.v3"
)

// PreProcessFunc is a function that transforms input data before parsing.
type PreProcessFunc func(data map[string]interface{}) map[string]interface{}

// PostProcessFunc is a function that transforms the result after instantiation.
type PostProcessFunc func(result interface{}) interface{}

// PreSaveFunc is a function that transforms an object before serialization.
type PreSaveFunc func(obj interface{}) interface{}

// PostSaveFunc is a function that transforms a dictionary after serialization.
type PostSaveFunc func(data map[string]interface{}) map[string]interface{}

// LoadContext provides context for loading operations.
type LoadContext struct {
	// PreProcess is an optional callback to transform input data before parsing.
	PreProcess PreProcessFunc
	// PostProcess is an optional callback to transform the result after instantiation.
	PostProcess PostProcessFunc
}

// NewLoadContext creates a new LoadContext with default values.
func NewLoadContext() *LoadContext {
	return &LoadContext{}
}

// ProcessInput applies pre-processing to input data if a PreProcess callback is set.
func (c *LoadContext) ProcessInput(data map[string]interface{}) map[string]interface{} {
	if c.PreProcess != nil {
		return c.PreProcess(data)
	}
	return data
}

// ProcessOutput applies post-processing to the result if a PostProcess callback is set.
func (c *LoadContext) ProcessOutput(result interface{}) interface{} {
	if c.PostProcess != nil {
		return c.PostProcess(result)
	}
	return result
}

// SaveContext provides context for saving operations.
type SaveContext struct {
	// PreSave is an optional callback to transform the object before serialization.
	PreSave PreSaveFunc
	// PostSave is an optional callback to transform the dictionary after serialization.
	PostSave PostSaveFunc
	// CollectionFormat is the output format for collections: "object" (name as key) or "array" (list of dicts).
	// Defaults to "object".
	CollectionFormat string
	// UseShorthand indicates whether to use shorthand scalar representation when possible.
	// Defaults to true.
	UseShorthand bool
}

// NewSaveContext creates a new SaveContext with default values.
func NewSaveContext() *SaveContext {
	return &SaveContext{
		CollectionFormat: "object",
		UseShorthand:     true,
	}
}

// ProcessObject applies pre-processing to the object if a PreSave callback is set.
func (c *SaveContext) ProcessObject(obj interface{}) interface{} {
	if c.PreSave != nil {
		return c.PreSave(obj)
	}
	return obj
}

// ProcessDict applies post-processing to the dictionary if a PostSave callback is set.
func (c *SaveContext) ProcessDict(data map[string]interface{}) map[string]interface{} {
	if c.PostSave != nil {
		return c.PostSave(data)
	}
	return data
}

// ToYAML converts a dictionary to a YAML string.
func (c *SaveContext) ToYAML(data map[string]interface{}) (string, error) {
	bytes, err := yaml.Marshal(data)
	if err != nil {
		return "", err
	}
	return string(bytes), nil
}

// ToJSON converts a dictionary to a JSON string.
func (c *SaveContext) ToJSON(data map[string]interface{}) (string, error) {
	bytes, err := json.MarshalIndent(data, "", "  ")
	if err != nil {
		return "", err
	}
	return string(bytes), nil
}
