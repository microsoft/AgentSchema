

// Code generated by AgentSchema emitter; DO NOT EDIT.

package agentschema_test

import (
"encoding/json"
"testing"

"gopkg.in/yaml.v3"

"github.com/microsoft/agentschema-go/agentschema"
)


// TestAgentManifestLoadJSON tests loading AgentManifest from JSON
func TestAgentManifestLoadJSON(t *testing.T) {
jsonData := `
{
  "name": "basic-prompt",
  "displayName": "My Basic Prompt",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "template": {
    "kind": "prompt",
    "model": "{{model_name}}",
    "instructions": "You are a poet named {{agent_name}}. Rhyme all your responses."
  },
  "parameters": {
    "strict": true,
    "properties": [
      {
        "name": "model_name",
        "kind": "string",
        "value": "gpt-4o"
      },
      {
        "name": "agent_name",
        "kind": "string",
        "value": "Research Agent"
      }
    ]
  },
  "resources": {
    "gptModelDeployment": {
      "kind": "model",
      "id": "gpt-4o"
    },
    "webSearchInstance": {
      "kind": "tool",
      "id": "web-search",
      "options": {
        "apiKey": "my-api-key"
      }
    }
  }
}
`
var data map[string]interface{}
if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
t.Fatalf("Failed to parse JSON: %v", err)
}

ctx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, ctx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
if instance.Name != "basic-prompt" {
t.Errorf(`Expected Name to be "basic-prompt", got %v`, instance.Name)
}
if instance.DisplayName != "My Basic Prompt" {
t.Errorf(`Expected DisplayName to be "My Basic Prompt", got %v`, instance.DisplayName)
}
if instance.Description == nil || *instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
t.Errorf(`Expected Description to be "A basic prompt that uses the GPT-3 chat API to answer questions", got %v`, instance.Description)
}
}

// TestAgentManifestLoadYAML tests loading AgentManifest from YAML
func TestAgentManifestLoadYAML(t *testing.T) {
yamlData := `
name: basic-prompt
displayName: My Basic Prompt
description: A basic prompt that uses the GPT-3 chat API to answer questions
metadata:
  authors:
    - sethjuarez
    - jietong
  tags:
    - example
    - prompt
template:
  kind: prompt
  model: "{{model_name}}"
  instructions: You are a poet named {{agent_name}}. Rhyme all your responses.
parameters:
  strict: true
  properties:
    - name: model_name
      kind: string
      value: gpt-4o
    - name: agent_name
      kind: string
      value: Research Agent
resources:
  gptModelDeployment:
    kind: model
    id: gpt-4o
  webSearchInstance:
    kind: tool
    id: web-search
    options:
      apiKey: my-api-key

`
var data map[string]interface{}
if err := yaml.Unmarshal([]byte(yamlData), &data); err != nil {
t.Fatalf("Failed to parse YAML: %v", err)
}

ctx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, ctx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
if instance.Name != "basic-prompt" {
t.Errorf(`Expected Name to be "basic-prompt", got %v`, instance.Name)
}
if instance.DisplayName != "My Basic Prompt" {
t.Errorf(`Expected DisplayName to be "My Basic Prompt", got %v`, instance.DisplayName)
}
if instance.Description == nil || *instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
t.Errorf(`Expected Description to be "A basic prompt that uses the GPT-3 chat API to answer questions", got %v`, instance.Description)
}
}

// TestAgentManifestRoundtrip tests load -> save -> load produces equivalent data
func TestAgentManifestRoundtrip(t *testing.T) {
jsonData := `
{
  "name": "basic-prompt",
  "displayName": "My Basic Prompt",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "template": {
    "kind": "prompt",
    "model": "{{model_name}}",
    "instructions": "You are a poet named {{agent_name}}. Rhyme all your responses."
  },
  "parameters": {
    "strict": true,
    "properties": [
      {
        "name": "model_name",
        "kind": "string",
        "value": "gpt-4o"
      },
      {
        "name": "agent_name",
        "kind": "string",
        "value": "Research Agent"
      }
    ]
  },
  "resources": {
    "gptModelDeployment": {
      "kind": "model",
      "id": "gpt-4o"
    },
    "webSearchInstance": {
      "kind": "tool",
      "id": "web-search",
      "options": {
        "apiKey": "my-api-key"
      }
    }
  }
}
`
var data map[string]interface{}
if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
t.Fatalf("Failed to parse JSON: %v", err)
}

loadCtx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, loadCtx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
saveCtx := agentschema.NewSaveContext()
savedData := instance.Save(saveCtx)

reloaded, err := agentschema.LoadAgentManifest(savedData, loadCtx)
if err != nil {
t.Fatalf("Failed to reload AgentManifest: %v", err)
}
if reloaded.Name != "basic-prompt" {
t.Errorf(`Expected Name to be "basic-prompt", got %v`, reloaded.Name)
}
if reloaded.DisplayName != "My Basic Prompt" {
t.Errorf(`Expected DisplayName to be "My Basic Prompt", got %v`, reloaded.DisplayName)
}
if reloaded.Description == nil || *reloaded.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
t.Errorf(`Expected Description to be "A basic prompt that uses the GPT-3 chat API to answer questions", got %v`, reloaded.Description)
}
}

// TestAgentManifestToJSON tests that ToJSON produces valid JSON
func TestAgentManifestToJSON(t *testing.T) {
jsonData := `
{
  "name": "basic-prompt",
  "displayName": "My Basic Prompt",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "template": {
    "kind": "prompt",
    "model": "{{model_name}}",
    "instructions": "You are a poet named {{agent_name}}. Rhyme all your responses."
  },
  "parameters": {
    "strict": true,
    "properties": [
      {
        "name": "model_name",
        "kind": "string",
        "value": "gpt-4o"
      },
      {
        "name": "agent_name",
        "kind": "string",
        "value": "Research Agent"
      }
    ]
  },
  "resources": {
    "gptModelDeployment": {
      "kind": "model",
      "id": "gpt-4o"
    },
    "webSearchInstance": {
      "kind": "tool",
      "id": "web-search",
      "options": {
        "apiKey": "my-api-key"
      }
    }
  }
}
`
var data map[string]interface{}
if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
t.Fatalf("Failed to parse JSON: %v", err)
}

ctx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, ctx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
jsonOutput, err := instance.ToJSON()
if err != nil {
t.Fatalf("Failed to convert to JSON: %v", err)
}

var parsed map[string]interface{}
if err := json.Unmarshal([]byte(jsonOutput), &parsed); err != nil {
t.Fatalf("Failed to parse generated JSON: %v", err)
}
}

// TestAgentManifestToYAML tests that ToYAML produces valid YAML
func TestAgentManifestToYAML(t *testing.T) {
jsonData := `
{
  "name": "basic-prompt",
  "displayName": "My Basic Prompt",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "template": {
    "kind": "prompt",
    "model": "{{model_name}}",
    "instructions": "You are a poet named {{agent_name}}. Rhyme all your responses."
  },
  "parameters": {
    "strict": true,
    "properties": [
      {
        "name": "model_name",
        "kind": "string",
        "value": "gpt-4o"
      },
      {
        "name": "agent_name",
        "kind": "string",
        "value": "Research Agent"
      }
    ]
  },
  "resources": {
    "gptModelDeployment": {
      "kind": "model",
      "id": "gpt-4o"
    },
    "webSearchInstance": {
      "kind": "tool",
      "id": "web-search",
      "options": {
        "apiKey": "my-api-key"
      }
    }
  }
}
`
var data map[string]interface{}
if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
t.Fatalf("Failed to parse JSON: %v", err)
}

ctx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, ctx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
yamlOutput, err := instance.ToYAML()
if err != nil {
t.Fatalf("Failed to convert to YAML: %v", err)
}

var parsed map[string]interface{}
if err := yaml.Unmarshal([]byte(yamlOutput), &parsed); err != nil {
t.Fatalf("Failed to parse generated YAML: %v", err)
}
}


// TestAgentManifestLoadJSON1 tests loading AgentManifest from JSON
func TestAgentManifestLoadJSON1(t *testing.T) {
jsonData := `
{
  "name": "basic-prompt",
  "displayName": "My Basic Prompt",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "template": {
    "kind": "prompt",
    "model": "{{model_name}}",
    "instructions": "You are a poet named {{agent_name}}. Rhyme all your responses."
  },
  "parameters": {
    "strict": true,
    "properties": [
      {
        "name": "model_name",
        "kind": "string",
        "value": "gpt-4o"
      },
      {
        "name": "agent_name",
        "kind": "string",
        "value": "Research Agent"
      }
    ]
  },
  "resources": [
    {
      "kind": "model",
      "name": "gptModelDeployment",
      "id": "gpt-4o"
    },
    {
      "kind": "tool",
      "name": "webSearchInstance",
      "id": "web-search",
      "options": {
        "apiKey": "my-api-key"
      }
    }
  ]
}
`
var data map[string]interface{}
if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
t.Fatalf("Failed to parse JSON: %v", err)
}

ctx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, ctx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
if instance.Name != "basic-prompt" {
t.Errorf(`Expected Name to be "basic-prompt", got %v`, instance.Name)
}
if instance.DisplayName != "My Basic Prompt" {
t.Errorf(`Expected DisplayName to be "My Basic Prompt", got %v`, instance.DisplayName)
}
if instance.Description == nil || *instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
t.Errorf(`Expected Description to be "A basic prompt that uses the GPT-3 chat API to answer questions", got %v`, instance.Description)
}
}

// TestAgentManifestLoadYAML1 tests loading AgentManifest from YAML
func TestAgentManifestLoadYAML1(t *testing.T) {
yamlData := `
name: basic-prompt
displayName: My Basic Prompt
description: A basic prompt that uses the GPT-3 chat API to answer questions
metadata:
  authors:
    - sethjuarez
    - jietong
  tags:
    - example
    - prompt
template:
  kind: prompt
  model: "{{model_name}}"
  instructions: You are a poet named {{agent_name}}. Rhyme all your responses.
parameters:
  strict: true
  properties:
    - name: model_name
      kind: string
      value: gpt-4o
    - name: agent_name
      kind: string
      value: Research Agent
resources:
  - kind: model
    name: gptModelDeployment
    id: gpt-4o
  - kind: tool
    name: webSearchInstance
    id: web-search
    options:
      apiKey: my-api-key

`
var data map[string]interface{}
if err := yaml.Unmarshal([]byte(yamlData), &data); err != nil {
t.Fatalf("Failed to parse YAML: %v", err)
}

ctx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, ctx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
if instance.Name != "basic-prompt" {
t.Errorf(`Expected Name to be "basic-prompt", got %v`, instance.Name)
}
if instance.DisplayName != "My Basic Prompt" {
t.Errorf(`Expected DisplayName to be "My Basic Prompt", got %v`, instance.DisplayName)
}
if instance.Description == nil || *instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
t.Errorf(`Expected Description to be "A basic prompt that uses the GPT-3 chat API to answer questions", got %v`, instance.Description)
}
}

// TestAgentManifestRoundtrip1 tests load -> save -> load produces equivalent data
func TestAgentManifestRoundtrip1(t *testing.T) {
jsonData := `
{
  "name": "basic-prompt",
  "displayName": "My Basic Prompt",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "template": {
    "kind": "prompt",
    "model": "{{model_name}}",
    "instructions": "You are a poet named {{agent_name}}. Rhyme all your responses."
  },
  "parameters": {
    "strict": true,
    "properties": [
      {
        "name": "model_name",
        "kind": "string",
        "value": "gpt-4o"
      },
      {
        "name": "agent_name",
        "kind": "string",
        "value": "Research Agent"
      }
    ]
  },
  "resources": [
    {
      "kind": "model",
      "name": "gptModelDeployment",
      "id": "gpt-4o"
    },
    {
      "kind": "tool",
      "name": "webSearchInstance",
      "id": "web-search",
      "options": {
        "apiKey": "my-api-key"
      }
    }
  ]
}
`
var data map[string]interface{}
if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
t.Fatalf("Failed to parse JSON: %v", err)
}

loadCtx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, loadCtx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
saveCtx := agentschema.NewSaveContext()
savedData := instance.Save(saveCtx)

reloaded, err := agentschema.LoadAgentManifest(savedData, loadCtx)
if err != nil {
t.Fatalf("Failed to reload AgentManifest: %v", err)
}
if reloaded.Name != "basic-prompt" {
t.Errorf(`Expected Name to be "basic-prompt", got %v`, reloaded.Name)
}
if reloaded.DisplayName != "My Basic Prompt" {
t.Errorf(`Expected DisplayName to be "My Basic Prompt", got %v`, reloaded.DisplayName)
}
if reloaded.Description == nil || *reloaded.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
t.Errorf(`Expected Description to be "A basic prompt that uses the GPT-3 chat API to answer questions", got %v`, reloaded.Description)
}
}

// TestAgentManifestToJSON1 tests that ToJSON produces valid JSON
func TestAgentManifestToJSON1(t *testing.T) {
jsonData := `
{
  "name": "basic-prompt",
  "displayName": "My Basic Prompt",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "template": {
    "kind": "prompt",
    "model": "{{model_name}}",
    "instructions": "You are a poet named {{agent_name}}. Rhyme all your responses."
  },
  "parameters": {
    "strict": true,
    "properties": [
      {
        "name": "model_name",
        "kind": "string",
        "value": "gpt-4o"
      },
      {
        "name": "agent_name",
        "kind": "string",
        "value": "Research Agent"
      }
    ]
  },
  "resources": [
    {
      "kind": "model",
      "name": "gptModelDeployment",
      "id": "gpt-4o"
    },
    {
      "kind": "tool",
      "name": "webSearchInstance",
      "id": "web-search",
      "options": {
        "apiKey": "my-api-key"
      }
    }
  ]
}
`
var data map[string]interface{}
if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
t.Fatalf("Failed to parse JSON: %v", err)
}

ctx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, ctx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
jsonOutput, err := instance.ToJSON()
if err != nil {
t.Fatalf("Failed to convert to JSON: %v", err)
}

var parsed map[string]interface{}
if err := json.Unmarshal([]byte(jsonOutput), &parsed); err != nil {
t.Fatalf("Failed to parse generated JSON: %v", err)
}
}

// TestAgentManifestToYAML1 tests that ToYAML produces valid YAML
func TestAgentManifestToYAML1(t *testing.T) {
jsonData := `
{
  "name": "basic-prompt",
  "displayName": "My Basic Prompt",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "template": {
    "kind": "prompt",
    "model": "{{model_name}}",
    "instructions": "You are a poet named {{agent_name}}. Rhyme all your responses."
  },
  "parameters": {
    "strict": true,
    "properties": [
      {
        "name": "model_name",
        "kind": "string",
        "value": "gpt-4o"
      },
      {
        "name": "agent_name",
        "kind": "string",
        "value": "Research Agent"
      }
    ]
  },
  "resources": [
    {
      "kind": "model",
      "name": "gptModelDeployment",
      "id": "gpt-4o"
    },
    {
      "kind": "tool",
      "name": "webSearchInstance",
      "id": "web-search",
      "options": {
        "apiKey": "my-api-key"
      }
    }
  ]
}
`
var data map[string]interface{}
if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
t.Fatalf("Failed to parse JSON: %v", err)
}

ctx := agentschema.NewLoadContext()
instance, err := agentschema.LoadAgentManifest(data, ctx)
if err != nil {
t.Fatalf("Failed to load AgentManifest: %v", err)
}
yamlOutput, err := instance.ToYAML()
if err != nil {
t.Fatalf("Failed to convert to YAML: %v", err)
}

var parsed map[string]interface{}
if err := yaml.Unmarshal([]byte(yamlOutput), &parsed); err != nil {
t.Fatalf("Failed to parse generated YAML: %v", err)
}
}



