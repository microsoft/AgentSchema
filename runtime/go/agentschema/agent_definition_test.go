// Code generated by AgentSchema emitter; DO NOT EDIT.

package agentschema_test

import (
	"encoding/json"
	"testing"

	"gopkg.in/yaml.v3"

	"github.com/microsoft/agentschema-go/agentschema"
)

// TestAgentDefinitionLoadJSON tests loading AgentDefinition from JSON
func TestAgentDefinitionLoadJSON(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": {
      "firstName": {
        "kind": "string",
        "value": "Jane"
      },
      "lastName": {
        "kind": "string",
        "value": "Doe"
      },
      "question": {
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    }
  },
  "outputSchema": {
    "properties": {
      "answer": {
        "kind": "string",
        "description": "The answer to the user's question."
      }
    }
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}
	if instance.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", instance.Kind)
	}
	if instance.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", instance.Name)
	}
	if instance.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", instance.DisplayName)
	}
	if instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", instance.Description)
	}
}

// TestAgentDefinitionLoadYAML tests loading AgentDefinition from YAML
func TestAgentDefinitionLoadYAML(t *testing.T) {
	yamlData := `
kind: prompt
name: basic-prompt
displayName: Basic Prompt Agent
description: A basic prompt that uses the GPT-3 chat API to answer questions
metadata:
  authors:
    - sethjuarez
    - jietong
  tags:
    - example
    - prompt
inputSchema:
  properties:
    firstName:
      kind: string
      value: Jane
    lastName:
      kind: string
      value: Doe
    question:
      kind: string
      value: What is the meaning of life?
outputSchema:
  properties:
    answer:
      kind: string
      description: The answer to the user's question.

`
	var data map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlData), &data); err != nil {
		t.Fatalf("Failed to parse YAML: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}
	if instance.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", instance.Kind)
	}
	if instance.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", instance.Name)
	}
	if instance.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", instance.DisplayName)
	}
	if instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", instance.Description)
	}
}

// TestAgentDefinitionRoundtrip tests load -> save -> load produces equivalent data
func TestAgentDefinitionRoundtrip(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": {
      "firstName": {
        "kind": "string",
        "value": "Jane"
      },
      "lastName": {
        "kind": "string",
        "value": "Doe"
      },
      "question": {
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    }
  },
  "outputSchema": {
    "properties": {
      "answer": {
        "kind": "string",
        "description": "The answer to the user's question."
      }
    }
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	loadCtx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, loadCtx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	saveCtx := agentschema.NewSaveContext()
	savedData := instance.Save(saveCtx)

	reloaded, err := agentschema.LoadAgentDefinition(savedData, loadCtx)
	if err != nil {
		t.Fatalf("Failed to reload AgentDefinition: %v", err)
	}
	if reloaded.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", reloaded.Kind)
	}
	if reloaded.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", reloaded.Name)
	}
	if reloaded.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", reloaded.DisplayName)
	}
	if reloaded.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", reloaded.Description)
	}
}

// TestAgentDefinitionToJSON tests that ToJSON produces valid JSON
func TestAgentDefinitionToJSON(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": {
      "firstName": {
        "kind": "string",
        "value": "Jane"
      },
      "lastName": {
        "kind": "string",
        "value": "Doe"
      },
      "question": {
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    }
  },
  "outputSchema": {
    "properties": {
      "answer": {
        "kind": "string",
        "description": "The answer to the user's question."
      }
    }
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	jsonOutput, err := instance.ToJSON()
	if err != nil {
		t.Fatalf("Failed to convert to JSON: %v", err)
	}

	var parsed map[string]interface{}
	if err := json.Unmarshal([]byte(jsonOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated JSON: %v", err)
	}
}

// TestAgentDefinitionToYAML tests that ToYAML produces valid YAML
func TestAgentDefinitionToYAML(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": {
      "firstName": {
        "kind": "string",
        "value": "Jane"
      },
      "lastName": {
        "kind": "string",
        "value": "Doe"
      },
      "question": {
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    }
  },
  "outputSchema": {
    "properties": {
      "answer": {
        "kind": "string",
        "description": "The answer to the user's question."
      }
    }
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	yamlOutput, err := instance.ToYAML()
	if err != nil {
		t.Fatalf("Failed to convert to YAML: %v", err)
	}

	var parsed map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated YAML: %v", err)
	}
}

// TestAgentDefinitionLoadJSON1 tests loading AgentDefinition from JSON
func TestAgentDefinitionLoadJSON1(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": {
      "firstName": {
        "kind": "string",
        "value": "Jane"
      },
      "lastName": {
        "kind": "string",
        "value": "Doe"
      },
      "question": {
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    }
  },
  "outputSchema": {
    "properties": [
      {
        "name": "answer",
        "kind": "string",
        "description": "The answer to the user's question."
      }
    ]
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}
	if instance.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", instance.Kind)
	}
	if instance.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", instance.Name)
	}
	if instance.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", instance.DisplayName)
	}
	if instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", instance.Description)
	}
}

// TestAgentDefinitionLoadYAML1 tests loading AgentDefinition from YAML
func TestAgentDefinitionLoadYAML1(t *testing.T) {
	yamlData := `
kind: prompt
name: basic-prompt
displayName: Basic Prompt Agent
description: A basic prompt that uses the GPT-3 chat API to answer questions
metadata:
  authors:
    - sethjuarez
    - jietong
  tags:
    - example
    - prompt
inputSchema:
  properties:
    firstName:
      kind: string
      value: Jane
    lastName:
      kind: string
      value: Doe
    question:
      kind: string
      value: What is the meaning of life?
outputSchema:
  properties:
    - name: answer
      kind: string
      description: The answer to the user's question.

`
	var data map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlData), &data); err != nil {
		t.Fatalf("Failed to parse YAML: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}
	if instance.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", instance.Kind)
	}
	if instance.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", instance.Name)
	}
	if instance.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", instance.DisplayName)
	}
	if instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", instance.Description)
	}
}

// TestAgentDefinitionRoundtrip1 tests load -> save -> load produces equivalent data
func TestAgentDefinitionRoundtrip1(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": {
      "firstName": {
        "kind": "string",
        "value": "Jane"
      },
      "lastName": {
        "kind": "string",
        "value": "Doe"
      },
      "question": {
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    }
  },
  "outputSchema": {
    "properties": [
      {
        "name": "answer",
        "kind": "string",
        "description": "The answer to the user's question."
      }
    ]
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	loadCtx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, loadCtx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	saveCtx := agentschema.NewSaveContext()
	savedData := instance.Save(saveCtx)

	reloaded, err := agentschema.LoadAgentDefinition(savedData, loadCtx)
	if err != nil {
		t.Fatalf("Failed to reload AgentDefinition: %v", err)
	}
	if reloaded.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", reloaded.Kind)
	}
	if reloaded.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", reloaded.Name)
	}
	if reloaded.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", reloaded.DisplayName)
	}
	if reloaded.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", reloaded.Description)
	}
}

// TestAgentDefinitionToJSON1 tests that ToJSON produces valid JSON
func TestAgentDefinitionToJSON1(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": {
      "firstName": {
        "kind": "string",
        "value": "Jane"
      },
      "lastName": {
        "kind": "string",
        "value": "Doe"
      },
      "question": {
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    }
  },
  "outputSchema": {
    "properties": [
      {
        "name": "answer",
        "kind": "string",
        "description": "The answer to the user's question."
      }
    ]
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	jsonOutput, err := instance.ToJSON()
	if err != nil {
		t.Fatalf("Failed to convert to JSON: %v", err)
	}

	var parsed map[string]interface{}
	if err := json.Unmarshal([]byte(jsonOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated JSON: %v", err)
	}
}

// TestAgentDefinitionToYAML1 tests that ToYAML produces valid YAML
func TestAgentDefinitionToYAML1(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": {
      "firstName": {
        "kind": "string",
        "value": "Jane"
      },
      "lastName": {
        "kind": "string",
        "value": "Doe"
      },
      "question": {
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    }
  },
  "outputSchema": {
    "properties": [
      {
        "name": "answer",
        "kind": "string",
        "description": "The answer to the user's question."
      }
    ]
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	yamlOutput, err := instance.ToYAML()
	if err != nil {
		t.Fatalf("Failed to convert to YAML: %v", err)
	}

	var parsed map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated YAML: %v", err)
	}
}

// TestAgentDefinitionLoadJSON2 tests loading AgentDefinition from JSON
func TestAgentDefinitionLoadJSON2(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": [
      {
        "name": "firstName",
        "kind": "string",
        "value": "Jane"
      },
      {
        "name": "lastName",
        "kind": "string",
        "value": "Doe"
      },
      {
        "name": "question",
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    ]
  },
  "outputSchema": {
    "properties": {
      "answer": {
        "kind": "string",
        "description": "The answer to the user's question."
      }
    }
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}
	if instance.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", instance.Kind)
	}
	if instance.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", instance.Name)
	}
	if instance.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", instance.DisplayName)
	}
	if instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", instance.Description)
	}
}

// TestAgentDefinitionLoadYAML2 tests loading AgentDefinition from YAML
func TestAgentDefinitionLoadYAML2(t *testing.T) {
	yamlData := `
kind: prompt
name: basic-prompt
displayName: Basic Prompt Agent
description: A basic prompt that uses the GPT-3 chat API to answer questions
metadata:
  authors:
    - sethjuarez
    - jietong
  tags:
    - example
    - prompt
inputSchema:
  properties:
    - name: firstName
      kind: string
      value: Jane
    - name: lastName
      kind: string
      value: Doe
    - name: question
      kind: string
      value: What is the meaning of life?
outputSchema:
  properties:
    answer:
      kind: string
      description: The answer to the user's question.

`
	var data map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlData), &data); err != nil {
		t.Fatalf("Failed to parse YAML: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}
	if instance.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", instance.Kind)
	}
	if instance.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", instance.Name)
	}
	if instance.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", instance.DisplayName)
	}
	if instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", instance.Description)
	}
}

// TestAgentDefinitionRoundtrip2 tests load -> save -> load produces equivalent data
func TestAgentDefinitionRoundtrip2(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": [
      {
        "name": "firstName",
        "kind": "string",
        "value": "Jane"
      },
      {
        "name": "lastName",
        "kind": "string",
        "value": "Doe"
      },
      {
        "name": "question",
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    ]
  },
  "outputSchema": {
    "properties": {
      "answer": {
        "kind": "string",
        "description": "The answer to the user's question."
      }
    }
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	loadCtx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, loadCtx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	saveCtx := agentschema.NewSaveContext()
	savedData := instance.Save(saveCtx)

	reloaded, err := agentschema.LoadAgentDefinition(savedData, loadCtx)
	if err != nil {
		t.Fatalf("Failed to reload AgentDefinition: %v", err)
	}
	if reloaded.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", reloaded.Kind)
	}
	if reloaded.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", reloaded.Name)
	}
	if reloaded.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", reloaded.DisplayName)
	}
	if reloaded.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", reloaded.Description)
	}
}

// TestAgentDefinitionToJSON2 tests that ToJSON produces valid JSON
func TestAgentDefinitionToJSON2(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": [
      {
        "name": "firstName",
        "kind": "string",
        "value": "Jane"
      },
      {
        "name": "lastName",
        "kind": "string",
        "value": "Doe"
      },
      {
        "name": "question",
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    ]
  },
  "outputSchema": {
    "properties": {
      "answer": {
        "kind": "string",
        "description": "The answer to the user's question."
      }
    }
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	jsonOutput, err := instance.ToJSON()
	if err != nil {
		t.Fatalf("Failed to convert to JSON: %v", err)
	}

	var parsed map[string]interface{}
	if err := json.Unmarshal([]byte(jsonOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated JSON: %v", err)
	}
}

// TestAgentDefinitionToYAML2 tests that ToYAML produces valid YAML
func TestAgentDefinitionToYAML2(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": [
      {
        "name": "firstName",
        "kind": "string",
        "value": "Jane"
      },
      {
        "name": "lastName",
        "kind": "string",
        "value": "Doe"
      },
      {
        "name": "question",
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    ]
  },
  "outputSchema": {
    "properties": {
      "answer": {
        "kind": "string",
        "description": "The answer to the user's question."
      }
    }
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	yamlOutput, err := instance.ToYAML()
	if err != nil {
		t.Fatalf("Failed to convert to YAML: %v", err)
	}

	var parsed map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated YAML: %v", err)
	}
}

// TestAgentDefinitionLoadJSON3 tests loading AgentDefinition from JSON
func TestAgentDefinitionLoadJSON3(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": [
      {
        "name": "firstName",
        "kind": "string",
        "value": "Jane"
      },
      {
        "name": "lastName",
        "kind": "string",
        "value": "Doe"
      },
      {
        "name": "question",
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    ]
  },
  "outputSchema": {
    "properties": [
      {
        "name": "answer",
        "kind": "string",
        "description": "The answer to the user's question."
      }
    ]
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}
	if instance.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", instance.Kind)
	}
	if instance.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", instance.Name)
	}
	if instance.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", instance.DisplayName)
	}
	if instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", instance.Description)
	}
}

// TestAgentDefinitionLoadYAML3 tests loading AgentDefinition from YAML
func TestAgentDefinitionLoadYAML3(t *testing.T) {
	yamlData := `
kind: prompt
name: basic-prompt
displayName: Basic Prompt Agent
description: A basic prompt that uses the GPT-3 chat API to answer questions
metadata:
  authors:
    - sethjuarez
    - jietong
  tags:
    - example
    - prompt
inputSchema:
  properties:
    - name: firstName
      kind: string
      value: Jane
    - name: lastName
      kind: string
      value: Doe
    - name: question
      kind: string
      value: What is the meaning of life?
outputSchema:
  properties:
    - name: answer
      kind: string
      description: The answer to the user's question.

`
	var data map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlData), &data); err != nil {
		t.Fatalf("Failed to parse YAML: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}
	if instance.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", instance.Kind)
	}
	if instance.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", instance.Name)
	}
	if instance.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", instance.DisplayName)
	}
	if instance.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", instance.Description)
	}
}

// TestAgentDefinitionRoundtrip3 tests load -> save -> load produces equivalent data
func TestAgentDefinitionRoundtrip3(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": [
      {
        "name": "firstName",
        "kind": "string",
        "value": "Jane"
      },
      {
        "name": "lastName",
        "kind": "string",
        "value": "Doe"
      },
      {
        "name": "question",
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    ]
  },
  "outputSchema": {
    "properties": [
      {
        "name": "answer",
        "kind": "string",
        "description": "The answer to the user's question."
      }
    ]
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	loadCtx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, loadCtx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	saveCtx := agentschema.NewSaveContext()
	savedData := instance.Save(saveCtx)

	reloaded, err := agentschema.LoadAgentDefinition(savedData, loadCtx)
	if err != nil {
		t.Fatalf("Failed to reload AgentDefinition: %v", err)
	}
	if reloaded.Kind != "prompt" {
		t.Errorf("Expected Kind to be \"prompt\", got %v", reloaded.Kind)
	}
	if reloaded.Name != "basic-prompt" {
		t.Errorf("Expected Name to be \"basic-prompt\", got %v", reloaded.Name)
	}
	if reloaded.DisplayName != "Basic Prompt Agent" {
		t.Errorf("Expected DisplayName to be \"Basic Prompt Agent\", got %v", reloaded.DisplayName)
	}
	if reloaded.Description != "A basic prompt that uses the GPT-3 chat API to answer questions" {
		t.Errorf("Expected Description to be \"A basic prompt that uses the GPT-3 chat API to answer questions\", got %v", reloaded.Description)
	}
}

// TestAgentDefinitionToJSON3 tests that ToJSON produces valid JSON
func TestAgentDefinitionToJSON3(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": [
      {
        "name": "firstName",
        "kind": "string",
        "value": "Jane"
      },
      {
        "name": "lastName",
        "kind": "string",
        "value": "Doe"
      },
      {
        "name": "question",
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    ]
  },
  "outputSchema": {
    "properties": [
      {
        "name": "answer",
        "kind": "string",
        "description": "The answer to the user's question."
      }
    ]
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	jsonOutput, err := instance.ToJSON()
	if err != nil {
		t.Fatalf("Failed to convert to JSON: %v", err)
	}

	var parsed map[string]interface{}
	if err := json.Unmarshal([]byte(jsonOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated JSON: %v", err)
	}
}

// TestAgentDefinitionToYAML3 tests that ToYAML produces valid YAML
func TestAgentDefinitionToYAML3(t *testing.T) {
	jsonData := `
{
  "kind": "prompt",
  "name": "basic-prompt",
  "displayName": "Basic Prompt Agent",
  "description": "A basic prompt that uses the GPT-3 chat API to answer questions",
  "metadata": {
    "authors": [
      "sethjuarez",
      "jietong"
    ],
    "tags": [
      "example",
      "prompt"
    ]
  },
  "inputSchema": {
    "properties": [
      {
        "name": "firstName",
        "kind": "string",
        "value": "Jane"
      },
      {
        "name": "lastName",
        "kind": "string",
        "value": "Doe"
      },
      {
        "name": "question",
        "kind": "string",
        "value": "What is the meaning of life?"
      }
    ]
  },
  "outputSchema": {
    "properties": [
      {
        "name": "answer",
        "kind": "string",
        "description": "The answer to the user's question."
      }
    ]
  }
}
`
	var data map[string]interface{}
	if err := json.Unmarshal([]byte(jsonData), &data); err != nil {
		t.Fatalf("Failed to parse JSON: %v", err)
	}

	ctx := agentschema.NewLoadContext()
	instance, err := agentschema.LoadAgentDefinition(data, ctx)
	if err != nil {
		t.Fatalf("Failed to load AgentDefinition: %v", err)
	}

	yamlOutput, err := instance.ToYAML()
	if err != nil {
		t.Fatalf("Failed to convert to YAML: %v", err)
	}

	var parsed map[string]interface{}
	if err := yaml.Unmarshal([]byte(yamlOutput), &parsed); err != nil {
		t.Fatalf("Failed to parse generated YAML: %v", err)
	}
}
