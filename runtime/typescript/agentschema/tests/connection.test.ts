// Copyright (c) Microsoft. All rights reserved.
// WARNING: This is an auto-generated file. DO NOT EDIT THIS FILE DIRECTLY.

import { Connection } from "../src/index";

describe("Connection", () => {
  describe("JSON serialization", () => {
    it("should load from JSON - example 1", () => {
      const json = `{\n  "kind": "reference",\n  "authenticationMode": "system",\n  "usageDescription": "This will allow the agent to respond to an email on your behalf"\n}`;
      const instance = Connection.fromJson(json);
      expect(instance).toBeDefined();

      expect(instance.kind).toEqual("reference");

      expect(instance.authenticationMode).toEqual("system");

      expect(instance.usageDescription).toEqual(
        "This will allow the agent to respond to an email on your behalf"
      );
    });

    it("should round-trip JSON - example 1", () => {
      const json = `{\n  "kind": "reference",\n  "authenticationMode": "system",\n  "usageDescription": "This will allow the agent to respond to an email on your behalf"\n}`;
      const instance = Connection.fromJson(json);
      const output = instance.toJson();
      const reloaded = Connection.fromJson(output);

      expect(reloaded.kind).toEqual(instance.kind);

      expect(reloaded.authenticationMode).toEqual(instance.authenticationMode);

      expect(reloaded.usageDescription).toEqual(instance.usageDescription);
    });

    it("should serialize to valid JSON - example 1", () => {
      const json = `{\n  "kind": "reference",\n  "authenticationMode": "system",\n  "usageDescription": "This will allow the agent to respond to an email on your behalf"\n}`;
      const instance = Connection.fromJson(json);
      const output = instance.toJson();
      expect(output).toBeDefined();
      const parsed = JSON.parse(output);
      expect(typeof parsed).toBe("object");
    });
  });

  describe("YAML serialization", () => {
    it("should load from YAML - example 1", () => {
      const yaml = `kind: reference\nauthenticationMode: system\nusageDescription: This will allow the agent to respond to an email on your behalf\n`;
      const instance = Connection.fromYaml(yaml);
      expect(instance).toBeDefined();

      expect(instance.kind).toEqual("reference");

      expect(instance.authenticationMode).toEqual("system");

      expect(instance.usageDescription).toEqual(
        "This will allow the agent to respond to an email on your behalf"
      );
    });

    it("should round-trip YAML - example 1", () => {
      const yaml = `kind: reference\nauthenticationMode: system\nusageDescription: This will allow the agent to respond to an email on your behalf\n`;
      const instance = Connection.fromYaml(yaml);
      const output = instance.toYaml();
      const reloaded = Connection.fromYaml(output);

      expect(reloaded.kind).toEqual(instance.kind);

      expect(reloaded.authenticationMode).toEqual(instance.authenticationMode);

      expect(reloaded.usageDescription).toEqual(instance.usageDescription);
    });

    it("should serialize to valid YAML - example 1", () => {
      const yaml = `kind: reference\nauthenticationMode: system\nusageDescription: This will allow the agent to respond to an email on your behalf\n`;
      const instance = Connection.fromYaml(yaml);
      const output = instance.toYaml();
      expect(output).toBeDefined();
      // YAML output should be parseable back
      const reloaded = Connection.fromYaml(output);
      expect(reloaded).toBeDefined();
    });
  });
});
