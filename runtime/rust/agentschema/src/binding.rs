// Code generated by AgentSchema emitter; DO NOT EDIT.

#[allow(unused_imports)]
use crate::*;

#[doc(hidden)]
#[derive(serde::Deserialize)]
struct _BindingFields {
    #[serde(rename = "name", default)]
    name: String,
    #[serde(rename = "input", default)]
    input: String,
}

#[doc(hidden)]
#[derive(serde::Deserialize)]
#[serde(untagged)]
enum _BindingRepr {
    Short(String),
    Full(_BindingFields),
}

/// Binding represents Represents a binding between an input property and a tool parameter.

#[derive(Debug, Clone, Default, serde::Serialize)]
pub struct Binding {
    #[serde(rename = "name", default)]
    pub name: String,
    #[serde(rename = "input", default)]
    pub input: String,
}

impl<'de> serde::Deserialize<'de> for Binding {
    fn deserialize<D: serde::Deserializer<'de>>(d: D) -> Result<Self, D::Error> {
        let repr = _BindingRepr::deserialize(d)?;
        match repr {
            _BindingRepr::Short(v) => {
                let expanded = serde_json::json!({
                    "input": v
                });
                let fields: _BindingFields = serde_json::from_value(expanded)
                    .map_err(|e| serde::de::Error::custom(e.to_string()))?;
                Ok(Binding {
                    name: fields.name,
                    input: fields.input,
                })
            }
            _BindingRepr::Full(f) => Ok(Binding {
                name: f.name,
                input: f.input,
            }),
        }
    }
}

impl Binding {
    /// Load from a JSON string.
    pub fn from_json(s: &str) -> Result<Self, String> {
        serde_json::from_str(s).map_err(|e| e.to_string())
    }

    /// Serialize to a JSON string.
    pub fn to_json(&self) -> Result<String, String> {
        serde_json::to_string(self).map_err(|e| e.to_string())
    }

    /// Load from a YAML string.
    pub fn from_yaml(s: &str) -> Result<Self, String> {
        serde_yaml::from_str(s).map_err(|e| e.to_string())
    }

    /// Serialize to a YAML string.
    pub fn to_yaml(&self) -> Result<String, String> {
        serde_yaml::to_string(self).map_err(|e| e.to_string())
    }
}
