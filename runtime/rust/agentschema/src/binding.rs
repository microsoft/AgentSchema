// Code generated by AgentSchema emitter; DO NOT EDIT.

use crate::context::{LoadContext, SaveContext};

/// Represents a binding between an input property and a tool parameter.
#[derive(Debug, Clone)]
pub struct Binding {
    /// Name of the binding
    pub name: String,
    /// The input property that will be bound to the tool parameter argument
    pub input: String,
}

impl Default for Binding {
    fn default() -> Self {
        Binding {
            name: String::from(""),
            input: String::from(""),
        }
    }
}

impl Binding {
    /// Create a new Binding with default values.
    pub fn new() -> Self {
        Self::default()
    }

    /// Load Binding from a JSON string.
    pub fn from_json(json: &str) -> Result<Self, serde_json::Error> {
        let value: serde_json::Value = serde_json::from_str(json)?;
        Ok(Self::load_from_value(&value))
    }

    /// Load Binding from a YAML string.
    pub fn from_yaml(yaml: &str) -> Result<Self, serde_yaml::Error> {
        let value: serde_json::Value = serde_yaml::from_str(yaml)?;
        Ok(Self::load_from_value(&value))
    }

    /// Load Binding from a `serde_json::Value`.
    pub fn load_from_value(value: &serde_json::Value) -> Self {
        let mut result = Self::default();
        if let Some(s) = value.as_str() {
            let value = s.to_string();
            let expansion = serde_json::json!({"input":value});
            return Self::load_from_value(&expansion);
        }
        // Load fields from JSON object
        result.name = value
            .get("name")
            .and_then(|v| v.as_str())
            .unwrap_or_default()
            .to_string();
        result.input = value
            .get("input")
            .and_then(|v| v.as_str())
            .unwrap_or_default()
            .to_string();
        result
    }

    /// Serialize Binding to a `serde_json::Value`.
    pub fn to_value(&self) -> serde_json::Value {
        let mut result = serde_json::Map::new();
        if !self.name.is_empty() {
            result.insert(
                "name".to_string(),
                serde_json::Value::String(self.name.clone()),
            );
        }
        if !self.input.is_empty() {
            result.insert(
                "input".to_string(),
                serde_json::Value::String(self.input.clone()),
            );
        }
        serde_json::Value::Object(result)
    }

    /// Serialize Binding to a JSON string.
    pub fn to_json(&self) -> Result<String, serde_json::Error> {
        serde_json::to_string_pretty(&self.to_value())
    }

    /// Serialize Binding to a YAML string.
    pub fn to_yaml(&self) -> Result<String, serde_yaml::Error> {
        serde_yaml::to_string(&self.to_value())
    }
}
